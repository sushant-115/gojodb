2025/05/29 19:17:11 Creating new BTree file...
2025/05/29 19:17:11 DEBUG: Writing header of 128 bytes to offset 0
2025/05/29 19:17:11 DEBUG: Allocated new page 1 on disk.
2025/05/29 19:17:11 DEBUG: Found empty frame 0 as victim
2025/05/29 19:17:11 DEBUG: New page 1 getting frame 0 (old page 0)
2025/05/29 19:17:11 DEBUG: New page 1 loaded into frame 0, pinCount: 1, isDirty: true
2025/05/29 19:17:11 SER: PageID 1, numKeys 0, isLeaf true, serializedLen: 3, calculatedChecksum: 0x73c7ad97
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 DEBUG: Writing header of 128 bytes to offset 0
2025/05/29 19:17:11 INFO: New B-tree database created at my_btree.db with root PageID 1, Degree 3
2025/05/29 19:17:11 BTree file created successfully.
2025/05/29 19:17:11 Inserting data...
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Inserted new key 10 into leaf node 1 at index 0. New numKeys: 1
2025/05/29 19:17:11 SER: PageID 1, numKeys 1, isLeaf true, serializedLen: 27, calculatedChecksum: 0x3b1c2784
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 DEBUG: Writing header of 128 bytes to offset 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 Data insertion complete.
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x3b1c2784, Calculated Checksum: 0x3b1c2784
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 1
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 BTree structure after inserts:
 PageID: 1 (Leaf: true, Keys: 1)
  Keys: [10]
  Values: [value_for_10]

2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 Current tree size: 1
2025/05/29 19:17:11 Deleting some keys...
2025/05/29 19:17:11 Attempting to delete key: 10
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x3b1c2784, Calculated Checksum: 0x3b1c2784
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 1
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x3b1c2784, Calculated Checksum: 0x3b1c2784
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 1
2025/05/29 19:17:11 DEBUG: Deleted key 10 from leaf node 1. New numKeys: 0
2025/05/29 19:17:11 SER: PageID 1, numKeys 0, isLeaf true, serializedLen: 3, calculatedChecksum: 0x73c7ad97
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 DEBUG: Writing header of 128 bytes to offset 0
2025/05/29 19:17:11 Successfully deleted key 10 (or it was already gone).
2025/05/29 19:17:11 Deletion attempts complete.
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 BTree structure after deletes:
 PageID: 1 (Leaf: true, Keys: 0)
  Keys: []
  Values: []

2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 Current tree size after delete: 0
2025/05/29 19:17:11 Verifying deleted keys...
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: true
2025/05/29 19:17:11 Key 10 correctly not found after deletion.
2025/05/29 19:17:11 Closing BTree...
2025/05/29 19:17:11 INFO: Closing B-tree database...
2025/05/29 19:17:11 DEBUG: Flushing all dirty pages from buffer pool...
2025/05/29 19:17:11 DEBUG: Flushing page 1 (frame 0) during FlushAllPages
2025/05/29 19:17:11 DEBUG: Finished FlushAllPages.
2025/05/29 19:17:11 INFO: B-tree database closed successfully.
2025/05/29 19:17:11 BTree closed.
2025/05/29 19:17:11 Reopening BTree file...
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 INFO: Existing B-tree database opened from my_btree.db. Root PageID: 1, Degree: 3, TreeSize: 0
2025/05/29 19:17:11 BTree reopened successfully.
2025/05/29 19:17:11 DEBUG: Found empty frame 0 as victim
2025/05/29 19:17:11 DEBUG: Page 1 not in buffer pool. Evicting frame 0 (old page 0)
2025/05/29 19:17:11 DEBUG: Reading page 1 from disk into frame 0
2025/05/29 19:17:11 DEBUG: Page 1 loaded into frame 0, pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 BTree structure after reopen:
 PageID: 1 (Leaf: true, Keys: 0)
  Keys: []
  Values: []

2025/05/29 19:17:11 Searching for keys in reopened tree...
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 ERROR: Key 10 not found in reopened tree!
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 ERROR: Key 5 not found in reopened tree!
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 ERROR: Key 7 not found in reopened tree!
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 ERROR: Key 25 not found in reopened tree!
2025/05/29 19:17:11 DEBUG: Page 1 found in buffer pool (frame 0), pinCount: 1
2025/05/29 19:17:11 DESER: PageID 1. Stored Checksum: 0x73c7ad97, Calculated Checksum: 0x73c7ad97
2025/05/29 19:17:11 DESER: Successfully deserialized PageID 1, isLeaf: true, numKeys: 0
2025/05/29 19:17:11 DEBUG: Unpinned page 1 (frame 0), new pinCount: 0, isDirty: false
2025/05/29 19:17:11 Deleted key 15 correctly NOT found in reopened tree.
2025/05/29 19:17:11 DEBUG: Read header from disk. Magic: 0x6010db00, Version: 1, PageSize: 4096
2025/05/29 19:17:11 Reopened tree size: 0 (should match size before close)
2025/05/29 19:17:11 Closing reopened BTree...
2025/05/29 19:17:11 INFO: Closing B-tree database...
2025/05/29 19:17:11 DEBUG: Flushing all dirty pages from buffer pool...
2025/05/29 19:17:11 DEBUG: Finished FlushAllPages.
2025/05/29 19:17:11 INFO: B-tree database closed successfully.
2025/05/29 19:17:11 BTree tests finished.
